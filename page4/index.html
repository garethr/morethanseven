<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      More than seven &middot; Gareth Rushgrove
    
  </title>

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-435455-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>



  <!-- CSS -->
  <link rel="stylesheet" href="/public/css/poole.css">
  <link rel="stylesheet" href="/public/css/syntax.css">
  <link rel="stylesheet" href="/public/css/hyde.css">
  <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface">

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/apple-touch-icon-144-precomposed.png">
                                 <link rel="shortcut icon" href="/public/favicon.ico">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">
</head>


  <body>

    <div class="sidebar">
   <script async type="text/javascript" src="//cdn.carbonads.com/carbon.js?zoneid=1673&serve=C6AILKT&placement=morethansevennet" id="_carbonads_js"></script>

   <div class="container sidebar-sticky">
    <div class="sidebar-about">
      <h1>
        <a href="/">
          More than seven
        </a>
      </h1>
      <p class="lead">Writing about code. Occasional other topics. Made by <a href="https://twitter.com/garethr">@garethr</a>.</p>
    </div>
  </div>
</div>


    <div class="content container">
      <div class="posts">
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2014/01/12/shell-provisioner-for-test-kitchen/">
        Shell provisioner for Test Kitchen
      </a>
    </h1>

    <span class="post-date">12 Jan 2014</span>

    <p>As of a few weeks ago <a href="http://kitchen.ci/">Test Kitchen</a> has a <a href="https://github.com/test-kitchen/test-kitchen/blob/master/lib/kitchen/provisioner/shell.rb">shell provisioner</a> as well as the original Chef provisioners. This opens up all sorts of interesting testing potential.</p>

<p>If you&#39;ve not already seen Test Kitchen, probably because you&#39;re not using Chef, it&#39;s a tool for integration testing infrastructure code. Configured by a simple YAML file it will setup a matrix of virtual machines, using Virtualbox, AWS, OpenStack and more, run some setup code (normally applying Chef recipes) and then run a test suite (with support for Bats, ShUnit2, Rspec and Serverspec). It&#39;s all very pluggable. With the addition of the shell provisioner it&#39;s useful to just about anyone. To try and prove that here&#39;s a hello world style example.</p>

<h2>Dependencies</h2>

<p>First we need to install Test Kitchen. We&#39;ll use vagrant and virtualbox for our example too so we need a few extra dependencies. I&#39;m going to assume you have bundler installed, if not you may be able to do so with <code>gem install bundler</code> but as the number of ways of setting a ruby environment up is greater than the number of people on the planet I&#39;ll have to defer to instructions elsewhere for getting that far.</p>

<p>First create a file called <code>Gemfile</code> with the following contents:</p>
<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="n">source</span> <span class="s2">&quot;https://rubygems.org&quot;</span>

<span class="n">gem</span> <span class="s2">&quot;test-kitchen&quot;</span><span class="p">,</span> <span class="ss">:git</span> <span class="o">=&gt;</span> <span class="s2">&quot;https://github.com/test-kitchen/test-kitchen.git&quot;</span>
<span class="n">gem</span> <span class="s2">&quot;kitchen-vagrant&quot;</span>
<span class="n">gem</span> <span class="s2">&quot;vagrant-wrapper&quot;</span>
</code></pre></div>
<p>Then run:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">bundle install
</code></pre></div>
<p>This should install the above software. Note that the shell provisioner is not yet in an official release so where installing direct from GitHub for the moment.</p>

<h2>Configuration</h2>

<p>Next we&#39;ll tell Test Kitchen what we want to do. As much for demonstration purposes I&#39;m going to grab one of the Puppetlabs boxes. This is just plain <a href="http://vagrantup.com">Vagrant</a> so feel free to substitude the <code>box</code> and <code>box_url</code> for alternatives you already have installed locally. Otherwise the first run will take a little longer as it downloads a large file.</p>

<p>Pull all of the following in a file called `.kitchen.yml&#39;.</p>
<div class="highlight"><pre><code class="language-yaml" data-lang="yaml"><span class="nn">---</span>
<span class="l-Scalar-Plain">driver</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">name</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">vagrant</span>

<span class="l-Scalar-Plain">provisioner</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">name</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">shell</span>

<span class="l-Scalar-Plain">platforms</span><span class="p-Indicator">:</span>
  <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">name</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">puppet-precise64</span>
    <span class="l-Scalar-Plain">driver_config</span><span class="p-Indicator">:</span>
      <span class="l-Scalar-Plain">box</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">puppet-precise64</span>
      <span class="l-Scalar-Plain">box_url</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">http://puppet-vagrant-boxes.puppetlabs.com/ubuntu-server-12042-x64-vbox4210.box</span>

<span class="l-Scalar-Plain">suites</span><span class="p-Indicator">:</span>
  <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">name</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">default</span>
</code></pre></div>
<p>The shell provisioner is going to look for a file called <code>bootstrap.sh</code> by default. You can overide this but we&#39;ll leave it for the moment. Our bootstrap script is going to do something very simple, install the ntp package. But the important part is it could do anything; run Salt, run Ansible, run Puppet, execute any arbitrary code we choose. In this case our script is completely self contained but if it needed some additional files we could put them in a directory called <code>data</code> and they would be copied to the newly created virtual machine under <code>/tmp/kitchen</code>.</p>
<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="c">#!/bin/bash</span>

apt-get install ntp -y
</code></pre></div>
<h2>Tests</h2>

<p>The last step is to write a test. I&#39;m suddently finding lots of excuses to use <a href="http://serverspec.org/">Serverspec</a> so we&#39;ll use that, but if you prefer you can use pretty much anything. The following file should be saved as  <code>test/integration/default/serverspec/ntp_spec.rb</code>. Note the <code>default</code> in the path which matches our suite above in the <code>.kitchen.yml</code> file. Test Kitchen allows for multiple suites all with separate tests based on a strong set of file path conventions.</p>
<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="nb">require</span> <span class="s1">&#39;serverspec&#39;</span>

<span class="kp">include</span> <span class="no">Serverspec</span><span class="o">::</span><span class="no">Helper</span><span class="o">::</span><span class="no">Exec</span>
<span class="kp">include</span> <span class="no">Serverspec</span><span class="o">::</span><span class="no">Helper</span><span class="o">::</span><span class="no">DetectOS</span>

<span class="no">RSpec</span><span class="o">.</span><span class="n">configure</span> <span class="k">do</span> <span class="o">|</span><span class="n">c</span><span class="o">|</span>
  <span class="n">c</span><span class="o">.</span><span class="n">before</span> <span class="ss">:all</span> <span class="k">do</span>
    <span class="n">c</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span> <span class="s1">&#39;/sbin:/usr/sbin&#39;</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="n">describe</span> <span class="n">package</span><span class="p">(</span><span class="s1">&#39;ntp&#39;</span><span class="p">)</span> <span class="k">do</span>
  <span class="n">it</span> <span class="p">{</span> <span class="n">should</span> <span class="n">be_installed</span> <span class="p">}</span>
<span class="k">end</span>

<span class="n">describe</span> <span class="n">service</span><span class="p">(</span><span class="s1">&#39;ntp&#39;</span><span class="p">)</span> <span class="k">do</span>
  <span class="n">it</span> <span class="p">{</span> <span class="n">should</span> <span class="n">be_enabled</span> <span class="p">}</span>
  <span class="n">it</span> <span class="p">{</span> <span class="n">should</span> <span class="n">be_running</span> <span class="p">}</span>
<span class="k">end</span>
</code></pre></div>
<h2>Running the tests</h2>

<p>With all of that in place we&#39;re ready to run our tests.</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">bundle exec kitchen test
</code></pre></div>
<p>This should:</p>

<ul>
<li>download the virtual machine image if you don&#39;t already have it locally</li>
<li>create a new virtual machine based on the image</li>
<li>run the bootstrap.sh script</li>
<li>run our serverspec test suite</li>
</ul>

<p>The real power comes from doing this iteratively as you work on code, probably code more complex than a simple one-line bash script. You can also test across multiple virtual machines at a time, for instance different operating systems or different machine roles. The <code>kitchen</code> command line tool provides lots of help too, with the ability to login to machines, verify that specific combinations of platform and suite are working and print lots of diagnotic information to aid development.</p>

<p>Hopefully this will make it into a release soon, and we&#39;ll see more involved examples using higher level tools and more documentation. But even now I&#39;d be looking at Test Kitchen for any infrastructure testing you might be doing.</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2014/01/01/testing-packer-created-images-with-serverspec/">
        Testing Packer created images with serverspec
      </a>
    </h1>

    <span class="post-date">01 Jan 2014</span>

    <p><a href="http://www.packer.io/">Packer</a> provides a great way of describing the steps for creating a virtual machine image. But it doesn&#39;t have a built-in way of verifying those images.</p>

<p><a href="http://serverspec.org/">Serverspec</a> provides a nice framework for writing tests against infrastructure, asserting the operation of services or the installation of packages.</p>

<p>I&#39;m interested at the moment in building continous delivery pipelines for infrastructure components and have a simple working example of <a href="https://github.com/garethr/packer-serverspec-example">testing Packer with Serverspec</a> on
Github. The example uses the AWS builder and the Puppet provisioner but the approach should work with other combinations.</p>

<p>This doesn&#39;t represent a complete infrastructure pipeline, but it does demonstrate an approach to automating one particular component - building base images.</p>

<h2>Testing</h2>

<p>In our example I&#39;m using the <a href="https://github.com/puppetlabs/puppetlabs-ntp">Puppetlabs NTP</a> module to install and configure NTP. Once the Puppet provisioner has run, but before we build the AMI (or other virtal machine image) we run a test suite. For our example the tests are pretty simple:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">describe package(&#39;ntp&#39;) do
  it { should be_installed }
end

describe service(&#39;ntp&#39;) do
  it { should be_enabled   }
  it { should be_running   }
end
</code></pre></div>
<p>If the tests fail, Packer will stop and the AMI won&#39;t be built. The combination of storing the code (Packer template) alongside a test suite (Serverspec) and building a new AMI whenever you change the code, makes this setup perfect for continuous integration. </p>

<h2>Wercker builds</h2>

<p>As an example of a continuous integration setup the repository contains a <a href="https://github.com/garethr/packer-serverspec-example/blob/master/wercker.yml">wercker.yml</a> configuration file for the excellent <a href="http://devcenter.wercker.com/">Wercker</a> service. Wercker makes setting up multi-step built pipelines easy and nicely configurable via a simple text file in your repository.</p>

<p>The Wercker <a href="https://app.wercker.com/#applications/52c450e489daaf145f001ad8">build for this project is public</a>. Currently the build involves downloading Packer, running <code>packer validate</code> to check the template and eventually running <code>packer build</code> to boot an instance and run our serverspec tests. </p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2013/12/29/making-the-web-secure/">
        Making the web secure, one unit test at a time
      </a>
    </h1>

    <span class="post-date">29 Dec 2013</span>

    <p><em>Originally written as part of <a href="http://sysadvent.blogspot.co.uk/2013/12/day-21-making-web-secure-one-unit-test.html">Sysadvent 2013</a>.</em></p>

<p>Writing automated tests for your code is one of those things that,
once you have gotten into it, you never want to see code without tests
ever again. Why write pages and pages of documentation about how
something should work when you can write tests to show exactly how something does work? Looking at the number and quality of testing tools and frameworks (like cucumber,
rspec, <a href="https://github.com/test-kitchen/test-kitchen">Test Kitchen</a>,
<a href="http://serverspec.org/">Server Spec</a>,
<a href="https://github.com/puppetlabs/beaker">Beaker</a>,
<a href="http://casperjs.org/">Casper</a> and
<a href="http://pivotal.github.io/jasmine/">Jasmine</a> to name a few) that have
popped up in the last year or so I&#39;m obviously not the only person who
has a thing for testing utilities.</p>

<p>One of the other things I am interested in is web application
security, so this post is all about using the tools and techniques
from unit testing to avoid common web application security issues. I&#39;m
using Ruby in the examples but you could quickly convert these to other languages if you desire.</p>

<h2>Any port in a storm</h2>

<p>Lets start out with something simple. Accidentally exposing
applications on TCP ports can lead to data loss or introduce a vector
for attack. Maybe your main website is super secure, but you left the
port for your database open to the internet. It&#39;s the server configuration equivalent of forgetting to lock the back door.</p>

<p>Nmap is a tool lots of people will be familiar with for spanning for
open ports. As well as a command line interface Nmap also has good
library support in lots of languages so lets try and write a simple
tests suite around it.</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">require &quot;tempfile&quot;
require &quot;nmap/program&quot;
require &quot;nmap/xml&quot;

describe &quot;the scanme.nmap.org website&quot; do
  file = Tempfile.new(&quot;nmap.xml&quot;)
  before(:all) do
    Nmap::Program.scan do |nmap|
      nmap.xml = file.path
      nmap.targets = &quot;scanme.nmap.org&quot;
    end
  end

  @open_ports = []
  Nmap::XML.new(&quot;scan.xml&quot;) do |xml|
    xml.each_host do |host|
      host.each_port do |port|
        @open_ports &lt;&lt; port.number if port.state == :open
      end
    end
  end
end
</code></pre></div>
<p>With the above code in place we can then write tests like:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">it &quot;should have two ports open&quot; do
 @open_ports.should have(2).items
end

it &quot;should have port 80 open&quot; do
 @open_ports.should include(80)
end

it &quot;should have port 22 closed&quot; do
 @open_ports.should_not include(22)
end
</code></pre></div>
<p>We can run these manually, but also potentially as part of a
continuous integration build or constantly as part of a monitoring
suite.</p>

<h2>Run the Guantlt</h2>

<p>We had to do quite a bit of work wrapping Nmap before we could write
the tests above. Wouldn&#39;t it be nice if someone had already wrapped
lots of useful security minded tools for us? <a href="http://gauntlt.org/">Gauntlt</a> is pretty much just that, it&#39;s a security testing framework based on cucumber which currently supports curl, nmap, sslyze, sqlmap, garmr and a bunch more tools in master. Lets do something more advanced than our port scanning test above by testing a URL for a SQL injection vulnerability.</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">@slow
Feature: Run sqlmap against a target
  Scenario: Identify SQL injection vulnerabilities
    Given &quot;sqlmap&quot; is installed
    And the following profile:
      | name       | value                                      |
      | target_url | http://localhost/sql-injection?number_id=1 |
    When I launch a &quot;sqlmap&quot; attack with:
      &quot;&quot;&quot;
      python &lt;sqlmap_path&gt; -u &lt;target_url&gt; —dbms sqlite —batch -v 0 —tables
      &quot;&quot;&quot;
    Then the output should contain:
      &quot;&quot;&quot;
      sqlmap identified the following injection points
      &quot;&quot;&quot;
    And the output should contain:
      &quot;&quot;&quot;
      [2 tables]
      +-----------------+
      | numbers         |
      | sqlite_sequence |
      +-----------------+
      &quot;&quot;&quot;
</code></pre></div>
<p>The Gauntlt team publish <a href="https://github.com/gauntlt/gauntlt/tree/master/examples">lots of examples</a> like this one alongside the source code, so getting started is easy. Gauntlt is very powerful, but as you&#39;ll see from the example above you need to know quite a bit about the underlying tools it is using. In the case above you need to know the various arguments to sqlmap and also how to interpret the output.</p>

<h2>Enter Prodder</h2>

<p><a href="https://github.com/garethr/prodder">Prodder</a> is a tool I put together
to automate a few specific types of security testing. In many ways
it&#39;s very similar to Gauntlt; it uses the cucumber testing framework
and uses some of the same tools (like nmap and sslyze) under the hood.
However rather than a general purpose security framework like Gauntlt,
Prodder is higher level and very opinionated. Here&#39;s an example:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">Feature: SSL
  In order to ensure secure connections
  I want to check the SSL configuration of my servers
  Background:
    Given &quot;sslyze.py&quot; is installed
    Scenario: Check SSLv2 is disabled
      When we test using the &quot;sslv2&quot; protocol
      Then the exit status should be 0
      And the output should contain &quot;SSLv2 disabled&quot;

    Scenario: Check certificate is trusted
      When we check the certificate
      Then the output should contain &quot;Certificate is Trusted&quot;
      And the output should match /OK — (Common|Subject
</code></pre></div>
<p>Alternative) Name Matches/
          And the output should not contain &quot;Signature Algorithm: md5&quot;
          And the output should not contain &quot;Signature Algorithm: md2&quot;
          And the output should contain &quot;Key Size: 2048&quot;</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">    Scenario: Check certificate renegotiations
      When we test certificate renegotiation
      Then the output should contain &quot;Client-initiated
</code></pre></div>
<p>Renegotiations: Rejected&quot;
          And the output should contain &quot;Secure Renegotiation: Supported&quot;</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">    Scenario: Check SSLv3 is not using weak ciphers
      When we test using the &quot;sslv3&quot; protocol
      Then the output should not contain &quot;Anon&quot;
      And the output should not contain &quot;96bits&quot;
      And the output should not contain &quot;40bits&quot;
      And the output should not contain &quot; 0bits&quot;
</code></pre></div>
<p>This is a little higher level than the Gauntlt example — it&#39;s not
exposing the workings of sslyze that is doing the actual testing. All
you need is an understanding of SSL certifcates. Even if you&#39;re not an
expert on SSL you can accept the aforementioned opinions of Prodder
about what good looks like. Prodder currently contains steps and
exampes for port scanning, SSL certificates and security minded HTTP
headers. If you already have a cucumber based test suite (including
one based on Gauntlt) you can reuse the step definitions in that too.</p>

<p>I&#39;m hoping to build upon Prodder, adding more types of tests and
getting agreement on the included opinions from the wider systems
administration community. By having a default set of shared assertions
about the expected security of out system we can more easily move onto
new projects, safe in the knowledge that a test will fail if someone
messes up our once secure configuration.</p>

<h2>I&#39;m convinced, what should I do next?</h2>

<p>As well as trying out some of the above tools and techniques for
yourself I&#39;d recommend encouraging more security conversations in your
development and operations teams. Here&#39;s a few  places to start with:</p>

<ul>
<li><a href="http://www.slideshare.net/beehooze/devopsday-london-ben-hughes-security">Ben Hughes from Etsy talking about security culture at Devopsdays London</a></li>
<li><a href="https://speakerdeck.com/garethr/security-monitoring-with-open-source-penetration-testing-tools">A presentation I gave at Velocity about using penetration testing tools for monitoring purposes</a></li>
<li><a href="http://www.slideshare.net/wickett/gauntlt-velocity-eu2013">A workshop, again from Velocity all about getting started with Gauntlt</a></li>
</ul>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2013/12/28/introducing-hyde/">
        Introducing Hyde
      </a>
    </h1>

    <span class="post-date">28 Dec 2013</span>

    <p>Hyde is a brazen two-column <a href="http://jekyllrb.com">Jekyll</a> theme that pairs a prominent sidebar with uncomplicated content. It&#39;s based on <a href="http://getpoole.com">Poole</a>, the Jekyll butler.</p>

<h3>Built on Poole</h3>

<p>Poole is the Jekyll Butler, serving as an upstanding and effective foundation for Jekyll themes by <a href="https://twitter.com/mdo">@mdo</a>. Poole, and every theme built on it (like Hyde here) includes the following:</p>

<ul>
<li>Complete Jekyll setup included (layouts, config, <a href="/404">404</a>, <a href="/atom.xml">RSS feed</a>, posts, and <a href="/about">example page</a>)</li>
<li>Mobile friendly design and development</li>
<li>Easily scalable text and component sizing with <code>rem</code> units in the CSS</li>
<li>Support for a wide gamut of HTML elements</li>
<li>Related posts (time-based, because Jekyll) below each post</li>
<li>Syntax highlighting, courtesy Pygments (the Python-based code snippet highlighter)</li>
</ul>

<h3>Hyde features</h3>

<p>In addition to the features of Poole, Hyde adds the following:</p>

<ul>
<li>Sidebar includes support for textual modules and a dynamically generated navigation with active link support</li>
<li>Two orientations for content and sidebar, default (left sidebar) and <a href="https://github.com/poole/lanyon#reverse-layout">reverse</a> (right sidebar), available via <code>&lt;body&gt;</code> classes</li>
<li><a href="https://github.com/poole/hyde#themes">Eight optional color schemes</a>, available via <code>&lt;body&gt;</code> classes</li>
</ul>

<p><a href="https://github.com/poole/hyde#readme">Head to the readme</a> to learn more.</p>

<h3>Browser support</h3>

<p>Hyde is by preference a forward-thinking project. In addition to the latest versions of Chrome, Safari (mobile and desktop), and Firefox, it is only compatible with Internet Explorer 9 and above.</p>

<h3>Download</h3>

<p>Hyde is developed on and hosted with GitHub. Head to the <a href="https://github.com/poole/hyde">GitHub repository</a> for downloads, bug reports, and features requests.</p>

<p>Thanks!</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2013/10/13/looking-into-monitoring-and-logging-tools/">
        Looking into monitoring and logging tools
      </a>
    </h1>

    <span class="post-date">13 Oct 2013</span>

    <p><em>Originally published on <a href="https://medium.com/p/1cbb173faa3a">Medium</a>.</em></p>

<p>We have a bunch of internal mailing lists at <a href="http://digital.cabinetoffice.gov.uk/">work</a>, and on one of them someone asked:</p>

<blockquote>
<p>we’re looking into monitoring/logging tools…</p>
</blockquote>

<p>I ended up writing a bit of a long reply which a few people found useful, so I thought I’d repost it here for posterity. I’m sure this will date but I think it’s a reasonable snapshot of the state of open source monitoring tools at the end of 2013.</p>

<p>Simply put, think about four elements and you won’t be far off on the
technical front. Miss one and you’re probably in trouble.</p>

<ul>
<li>logs</li>
<li>metric storage</li>
<li>metric collection</li>
<li>monitoring checks</li>
</ul>

<p>For logs, some combination of syslog at one end and elasticsearch and
<a href="http://www.elasticsearch.org/overview/kibana/">Kibana</a> at the other are probably the state of the open source art at
the moment. The shipping around is more interesting; <a href="http://logstash.net/">Logstash</a> is improving constantly, <a href="http://heka-docs.readthedocs.org/en/latest/">Heka</a> is an similar alternative from Mozilla, and <a href="http://fluentd.org/">Fluentd</a> looks nice too.</p>

<p>For pure metrics it’s all about <a href="http://graphite.wikidot.com/">Graphite</a>, which is both awesome and
perilous. Not much else really competes in the open source world at
present. Maybe <a href="http://opentsdb.net/">OpenTSB</a> (is you’re into a Hadoop stack.)</p>

<p>For collecting metrics on boxes I’d probably look at <a href="http://collectd.org/">collectd</a> or <a href="https://github.com/BrightcoveOS/Diamond">diamond</a> both of which have pros and cons but work well. <a href="https://github.com/etsy/statsd/">Statsd</a> is also useful here for different types of metric collection and aggregation. <a href="http://ganglia.sourceforge.net/">Ganglia</a> is interesting too, it combines some aspects of the metrics collection tools with an integrated storage and visualisation tool similar to Graphite.</p>

<p>Monitoring checks is a bit more painful. I’ve been experimenting with <a href="http://sensuapp.org/">Sensu</a> in hope of not installing Nagios. Nagios works but it’s just a bit ungainly. But you do need somewhere to write checks against metrics or other aspects of your system and to issue alerts.</p>

<p>At this point everyone loves dashboards, and <a href="http://shopify.github.io/dashing/">Dashing</a> is particularly lovely. <a href="https://github.com/paperlesspost/graphiti">Graphiti</a> and <a href="https://github.com/obfuscurity/tasseo">Tasseo</a> for Graphite are useful too.</p>

<p>For bonus points things like <a href="http://flapjack.io/">Flapjack</a> and <a href="http://riemann.io/">Reimann</a> provide some interesting extra capabilities around alert control or real time monitoring respectively.</p>

<p>And for that elusive top of the class grade take a look at <a href="http://codeascraft.com/2013/06/11/introducing-kale/">Kale</a>, which provides anomaly detection on top of Graphite and Elasticsearch .</p>

<p>You might be thinking that’s a lot of moving parts and you’d be right. If you’re a small project running all of that is too much overhead, turning to something like Zabbix might be more sensible.</p>

<p>Depending on money/sensitivity/control issues lots of nice and not so
nice commercial products exist. <a href="http://www.circonus.com/">Circonus</a>, <a href="http://www.splunk.com/">Splunk</a>, <a href="http://newrelic.com/">New Relic</a>, <a href="http://boundary.com/">Boundary</a> and <a href="https://metrics.librato.com/">Librato Metrics</a> are all lovely in different ways and provide part of the puzzle.</p>

<p>And that’s just the boring matter of tools. Now you get into alert design and other gnarly people stuff.</p>

<p>If you got this far you should watch all the <a href="http://vimeo.com/monitorama">Monitorama videos</a> too.</p>

  </div>
  
</div>

<div class="pagination">
  
    <a class="pagination-item older" href="/page5">Older</a>
  
  
    
      <a class="pagination-item newer" href="/page3">Newer</a>
    
  
</div>
    </div>

  </body>
</html>
