<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      More than seven &middot; Gareth Rushgrove
    
  </title>

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-435455-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>



  <!-- CSS -->
  <link rel="stylesheet" href="/public/css/poole.css">
  <link rel="stylesheet" href="/public/css/syntax.css">
  <link rel="stylesheet" href="/public/css/hyde.css">
  <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface">

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/apple-touch-icon-144-precomposed.png">
                                 <link rel="shortcut icon" href="/public/favicon.ico">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">
</head>


  <body>

    <div class="sidebar">
   <script async type="text/javascript" src="//cdn.carbonads.com/carbon.js?zoneid=1673&serve=C6AILKT&placement=morethansevennet" id="_carbonads_js"></script>

   <div class="container sidebar-sticky">
    <div class="sidebar-about">
      <h1>
        <a href="/">
          More than seven
        </a>
      </h1>
      <p class="lead">Writing about code mainly. Occasional other topics. Made by <a href="https://twitter.com/garethr">@garethr</a>.</p>
    </div>
  </div>
</div>


    <div class="content container">
      <div class="posts">
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2010/10/30/Chef-hello-world/">
        Chef Hello World
      </a>
    </h1>

    <span class="post-date">30 Oct 2010</span>

    <p>I&#8217;ve been playing with Chef recently, in particular the solo variant. The new job at FreeAgent meant setting up new development virtual machines and rather than just jot down instructions I decided to script everything. I&#8217;d been wanting an excuse to take a look at Chef for a while and it&#8217;s certainly suited to this sort of job.</p>
<p>Unfortunately the <em>getting started</em> documentation isn&#8217;t yet great. I&#8217;m pretty sure this will improve over time, I had exactly the same problem with the Puppet docs a year ago. The main problem I had was I wanted to know how to use it, not just how to download someone elses cookbook. What I wanted was the following, the absolute simplest thing that will work. A Hello World example for Chef if you will. I&#8217;ll say now that I&#8217;m not an expert, their may be ways of doing this that are even simpler, but this works for me. And before someone mentions knife or rake tasks a generator isn&#8217;t simpler. It might be better when you know what&#8217;s going on but until you do it&#8217;s a big ass abstraction that will just get in the way.</p>
<p>All my sample cookbook is going to do is install a single package, curl. I&#8217;m going to assume you have chef installed for this already. The documentation did an OK job of that, although I&#8217;m relativly familiar with installing gems. I did find that the default system packages on Ubuntu at least were way out of date. Either get the packages direct from opscode or use the gem.</p>
<p>First create a directory and file structure that looks like this:</p>
<pre>
-- config
   -- node.json
   -- solo.rb
-- cookbooks
   -- example
      -- recipes
         -- default.rb
</pre>
<p>When you run the chef-solo command you need to tell it a few bits of information. The minimum appears to be just telling it where to find the cookbook we&#8217;re going to create. I think you can call this file anything you like but in the tree above it&#8217;s called solo.rb.</p>
<pre>cookbook_path File.expand_path(File.join(File.dirname(__FILE__), '..', "    cookbooks"))</pre>
<p>Next up is the details of the given node. This in our very simple case is just a list of the recipes we want to run when we execure chef-solo. Put the following content in the node.json file in the config directory as indicated above:</p>
<pre>{
  "run_list": [ "recipe[example]" ]
}</pre>
<p>Last up we want to create a cookbook. Now you can go and download example cookbooks from all over the place. This is great for learning new tricks and commands but for me at least to begin with most of them were more complicated than I needed for my simple usecase. Lots of options. Lots of knowing the package names on different distros. I&#8217;m just calling this cookbook <em>example</em>. That means the folder in the cookbooks folder is called example and the run list above references example. Feel free to change this to whatever you like, or create new cookbooks with different names. Inside that folder we create a recipes folder and inside that we create a default.rb file with the following content.</p>
<pre>package "curl"</pre>
<p>And that&#8217;s it. A bigish directory structure, three files, each with about one line of content. Simple.</p>
<p>Now to run all that just issue the following command:</p>
<pre>sudo chef-solo -c config/solo.rb -j config/node.json</pre>
<p>This should output various messages to the console about what chef is doing and, when it&#8217;s finished, you should find curl has been installed. Try and add another line to the recipe for another package (or even a gem) and rerun the chef-solo command. Now go read the docs for all the other cool things you can do.</p>
  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2010/09/13/Working-for-freeagent/">
        Working For Freeagent
      </a>
    </h1>

    <span class="post-date">13 Sep 2010</span>

    <p>So, I&#8217;ve just accepted a new job at <a href="http://freeagentcentral.com">FreeAgent</a>, the rather snappy online small business accounting startup. I&#8217;ll be starting in about a month, when I get back from devopsdays in Hamburg.</p>
<p>I&#8217;m joining a pretty well knit group of designers and developers working on a pretty well loved piece of software. I&#8217;ve known Roan (one of the directors) for years, ever since the first Highland Fling conference I think. And the rest of the team seem a good mix of technical smarts and professionalism. Hopefully I can live up to their already high standards.</p>
<p>I&#8217;m looking forward to jumping into a decent sized Ruby project and getting properly reacquainted with Rails as well. I&#8217;ve spent most of the previous few years in the Python world so that should be a nice challenge. I&#8217;m constantly impressed with the number of high quality tools written in Ruby andRails 3 looks a genuinely nice piece of software. Hopefully with a bit more idiomatic ruby under my belt, more time on my hands and some new real world problems to solve I&#8217;ll increase my open source contributions and get back to writing again as well. I&#8217;ll likely be spending most of my time on those good developer staples new feature development, supporting existing code and scaling systems. I&#8217;ll also be involved in some operations stuff if I get chance, introducing software I&#8217;m a huge fan of and automating everything I can get my hands on.</p>
<p>The rest of the team are based up in Edinburgh but I&#8217;ll be working from home most of the time. I&#8217;m quite looking forward to working from Cambridge after having lived here for a few years. I&#8217;ll also get to see various friends in Edinburgh that I don&#8217;t get chance to meet up with very often and still have time to make it to London for the odd event or get together. I&#8217;ll likely be looking into coworking spaces or desk shares in and around Cambridge so if anyone has any recommendations.</p>
<p>Given this weeks pubstandards is apparently all about weddings, birthdays and new jobs (and I have all 3 within a month) it would be rude not to go along for at least one drink. If you&#8217;re around London I might see you there.</p>
  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2010/09/09/Script-running-web-interface-with-websockets/">
        Script Running Web Interface With Websockets
      </a>
    </h1>

    <span class="post-date">09 Sep 2010</span>

    <p>After something of a break I found a bit of time for some hacking at the weekend and decided to scratch a personal itch. I like writing shell scripts for everything from checking on things to deploying code. For anything that is more than just executing one command, or anything with detailed output or that takes a while I like to be able to see what&#8217;s going on. I also like to (OK, only sometimes) let other people run those commands and not all those people want to check something out and run a console. The web maks a pretty good interface for this sort of situation.</p>
<p>Enter <a href="http://github.com/garethr/bolt/">Bolt</a>. It&#8217;s my first proper go at using websockets for the communication between client and server, and my first stab at EventMachine. The code at the moment needs some improvement (tests, configurability, deployment options) but it works as a proof of concept.</p>
<p>It&#8217;s pretty simple, designed for running a single command at the push of a button and showing the results scroll past as they happen.</p>
<p><img src="http://image-host.appspot.com/i/img?id=agppbWFnZS1ob3N0cg0LEgVJbWFnZRi5lAEM" alt="Bolt script running interface"/></p>
<p>Hopefully it&#8217;s useful to a few more people, or at least it will be when I clean it up a bit. For more information head over to the <a href="http://github.com/garethr/bolt/">GitHub page</a>.</p>
  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2010/07/11/Git-pre-recieve-hook-for-integrity/">
        Git Pre Recieve Hook For Integrity
      </a>
    </h1>

    <span class="post-date">11 Jul 2010</span>

    <p>I&#8217;m getting married rather soon so time has been somewhat short (in a good way) for just hacking on stuff, but I&#8217;ve finally found a little bit of time to play with something I&#8217;ve been mulling over for a while. Namely a continuous deployment workflow using the integrity continous integration server.</p>
<p>I&#8217;m hoping to have an incredibly simple but fully operation example available at some point &#8211; mainly to act as a good discussion point. For now here&#8217;s my current pre-receive hook.</p>
<script src="http://gist.github.com/471711.js?file=pre-receive"></script>
  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2010/06/29/Python-what-to-use/">
        Python: What To Use?
      </a>
    </h1>

    <span class="post-date">29 Jun 2010</span>

    <p>My friend <a href="http://jamieonsoftware.com">Jamie Rumbelow</a> has started a new project and decided to use Python. He asked a great question over on <a href="http://stackoverflow.com/questions/3143115/architecting-from-scratch-in-python-what-to-use">Stack Overflow</a> which basically came down to <em>what should I use for my first proper Python web application project</em>. After a quick prompting on twitter I decided to have a go. I&#8217;ve cross posted my anwser below more because it took as long as a typical blog post to write.</p>
<h2>Frameworks</h2>
<p>OK, so I&#8217;m a little biased here as I currently make extensive use of Django and organise the Django User Group in London so bear that in mind when reading the following.</p>
<p>Start with Django because it&#8217;s a great gateway drug. Lots of documentation and literature, a very active community of people to talk to and lots of example code around the web.</p>
<p>That&#8217;s a completely non-technical reason. Pylons is probably purer in terms of Python philosophy (being much more a collection of discrete bits and pieces) but lots of the technical stuff is personal preference, at least until you get into Python more. Compare the very active Django tag on Stack Overflow with that of pylons or turbogears though and I&#8217;d argue getting started is simply easier with Django irrespective of anything to do with code.</p>
<p>Personally I default to Django, but find that an increasing amount of time I actually opt for writing using simpler micro frameworks (think Sinatra rather than Rails). Lots of things to choose from (<a href="http://fewagainstmany.com/blog/python-micro-frameworks-are-all-the-rage">good list here</a>). I tend to use <span class="caps">MNML</span> (because I wrote parts of it and it&#8217;s tiny) but others are actively developed. I tend to do this for small, stupid web services which are then strung together with a Django project in the middle serving people.</p>
<p>Worth noting here is appengine. You have to work within it&#8217;s limitations and it&#8217;s not designed for everything but it&#8217;s a great way to just play with Python and get something up and working quickly. It makes a great testbed for learning and experimentation.</p>
<h2>Mongo/<span class="caps">ORM</span></h2>
<p>On the MongoDB front you&#8217;ll likely want to look at the <a href="http://api.mongodb.org/python/">basic python mongo library</a> first to see if it has everything you need. If you really do want something a little more <span class="caps">ORM</span> like then <a href="http://hmarr.com/mongoengine/">mongoengine</a> might be what you&#8217;re looking for. A bunch of folks are also working on making Django specifically integrate more seamlessly with nosql backends. Some of that is for future Django releases, but <a href="http://www.allbuttonspressed.com/projects/django-nonrel">django-norel</a> has code now.</p>
<p>For relational data <a href="http://www.sqlalchemy.org/">SQLAlchemy</a> is good if you want something standalone. Django&#8217;s <span class="caps">ORM</span> is also excellent if you&#8217;re using Django.</p>
<h2><span class="caps">API</span></h2>
<p>The most official Oauth library is <a href="http://github.com/simplegeo/python-oauth2">python-oauth2</a>, which handily has a Django example as part of it&#8217;s docs.</p>
<p><a href="http://bitbucket.org/jespern/django-piston/wiki/Home">Piston</a> is a Django app which provides lots of tools for building APIs. It has the advantage of being pretty active and well maintained and in production all over the place. Other projects exist too, including <a href="http://zacharyvoase.github.com/dagny/">Dagny</a> which is an early attempt to create something akin to RESTful resources in Rails.</p>
<p>In reality any Python framework (or even just raw <span class="caps">WSGI</span> code) should be reasonably good for this sort of task.</p>
<h2>Testing</h2>
<p>Python has unittest as part of it&#8217;s standard library, and unittest2 is in python 2.7 (but <a href="http://pypi.python.org/pypi/unittest2/0.1.4">backported to previous versions too</a>). Some people also like <a href="http://code.google.com/p/python-nose/">Nose</a>, which is an alternative test runner with some additional features. <a href="http://twill.idyll.org/">Twill</a> is also nice, it&#8217;s a &#8220;a simple scripting language for Web browsing&#8221;, so handy for some functional testing. <a href="http://github.com/rlisagor/freshen">Freshen</a> is a port of cucumber to Python. I haven&#8217;t yet gotten round to using this in anger, but a quick look now suggests it&#8217;s much better than when I last looked.</p>
<p>I actually also use Ruby for high level testing of Python apps and apis because I love the combination of celerity and cucumber. But I&#8217;m weird and get funny looks from other Python people for this.</p>
<h2>Message Queues</h2>
<p>For a message queue, whatever language I&#8217;m using, I now always use RabbitMQ. I&#8217;ve had some success with stompserver in the past but Rabbit is awesome. Don&#8217;t worry that it&#8217;s not itself written in Python, neither is PostgresSQL, Nginx or MongoDB &#8211; all for good reason. What you care about are the libraries available. What you&#8217;re looking for here is <a href="http://barryp.org/software/py-amqplib/">py-amqplib</a> which is a low level library for talking amqp (the protocol for talking to rabbit as well as other message queues). I&#8217;ve also used <a href="http://github.com/ask/carrot/">Carrot</a>, which is easier to get started with and provides a nicer <span class="caps">API</span>. Think bunny in Ruby if you&#8217;re familiar with that.</p>
<h2>Environment</h2>
<p>Whatever bits and pieces you decide to use from the Python ecosystem I&#8217;d recommend getting to who <a href="http://clemesha.org/blog/2009/jul/05/modern-python-hacker-tools-virtualenv-fabric-pip/">pip and virtualenv</a> &#8211; note that fabric is also cool, but not essential and these docs are out of date on that tool). Think about using Ruby without gem, bundler or rvm and you&#8217;ll be in the right direction.</p>
  </div>
  
</div>

<div class="pagination">
  
    <a class="pagination-item older" href="/page17">Older</a>
  
  
    
      <a class="pagination-item newer" href="/page15">Newer</a>
    
  
</div>
    </div>

  </body>
</html>
